---
title: "TIL. 7월 3주차"
excerpt: "7월 3주차 TIL"
toc_sticky: true;
toc_label: "On this page"

categories:
  - TIL
tags:
  - TIL
last_modified_at: 2020-07-13T21:56:00-0900
---

# 7월 20일 월요일

curl 관련 문제에 봉착했다 .. 현재 해결 중  
사용중인 libcurl 버전이 0.7.4이고, 0.7.4에서는 분명 https를 지원한다고 되어 있는데 실제로 curl 콜을 해보면 Unsupported Protocol 에러가 떨어진다. 빨리 해결해야 할 텐데 말이다.

그리고 Postion, Position 정렬, FlexBox까지 정리 했다.

# 7월 21일 화요일
지금은 오후 10시 40분.. 나는 지금 회사. 머리를 식힐겸 블로깅을 한다.  
우선 월요일에 해결하지 못했던 문제는 해결 했다. 항상 고생하다가 딱 됐을 때 이 느낌은 정말이지 마약이 따로 없다. 엔돌핀이 확 돈다 ㅎㅎ  

1. libcurl로 https url을 콜 했을 때 Unssupported Protocol 에러가 떨어지는 이슈  
결론부터 말하면, 회사 소스에 링킹되어 있는 curl 바이너리에 libssl 종속성이 빠져 있어서 그렇다.  
그래서 터미널에서 curl로 https를 호출하면 잘 되고, 소스상에서 호출하면 안됐던 것  
( 터미널에서 호출하는 curl은 /usr/bin에 있다. )  
원인은 아직 못찾았는데.. 빌드 환경 문제인듯 하다. 다른 대리님 NUC에서는 똑같은 소스를 체크아웃받고 tools를 빌드해도 libssl 종속성이 잘 포함 되어 있다.  이것때문에 거의 하루를 날려먹었다.

2. HTTP 1.1 406 Error  
1번 문제를 해결하고 가지고 있는 파라미터들로 access_token을 구해서 메신저로 전송하려고 보니 406 Error가 떨어진다.  
이 에러를 찾아보니.. 다양한 이유가 있었다. UserAgent를 Mozilla로 설정 해야한다는 이슈도 있었고,  
헤더 속성 값을 똑같이 맞춰야 한다는 것도 봤었다. 결국은 API에서 요구하는 데이터들이 정확하게 맞아야 했던 것.  
분명 헤더를 요구사항에 맞게 했는데도 계속 406 에러가 떨어져서, 콘솔에서 curl 콜을 하면서 post data를 없이 날려보니 403 에러가 떨어졌다. 동일하게 소스상에서도 post data를 없이 보내보니 403 에러가 떨어지는 것을 확인 했다.  
결론은 post data가 문제였던 것.. 원래는 제이슨 데이터를 넣을 때 "UserName=%s&Password=%" 이런식으로 넣었었는데, 이렇게 하면 안되더라. 이리저리 찾아보면서 삽질한 결과 정확하게 제이슨 형태로 맞춰줬더니 된다.
`sprintf(post_data, "{\"content\":\"%s\"}"` 대충 이런식으로 말이다.  

3. content 내용에 개행이 들어가는 문제  
결국엔 지금 우리 회사의 경보 기능을 외부 메신저와 연동하는 작업을 하고 있는데, 기존에 사용하던 경보 메세지에 개행이 들어가 있다.  
이 개행 때문에 또 제대로 동작을 안한다. 정말 산넘어 산이다. 이건 내일 해결해야 할 것 같다.  

정말 하루종일 삽질만 했던 것 같다. 그래서 내가 앚기 회사에 있는건가..?  
그래도 얻어간게 있어서 오히려 기분은 좋다. 해결 못할 줄 알았는데 해결해서 오늘은 기분좋게 퇴근하고 꿀잠 잘듯!


